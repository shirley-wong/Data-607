---
title: "Data 607_Hw1_Mushroom_ColorTable"
author: "Sin Ying Wong"
date: "9/1/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Assignment 1 : Loading Data into Data Frame

**Mushrooms Dataset** A famous—if slightly moldy—dataset about mushrooms can be found in the UCI repository here: https://archive.ics.uci.edu/ml/datasets/Mushroom. The fact that this is such a well-known dataset in the data science community makes it a good dataset to use for comparative benchmarking. For example, if someone was working to build a better decision tree algorithm (or other predictive classifier) to analyze categorical data, this dataset could be useful. A typical problem (which is beyond the scope of this assignment!) is to answer the question, “Which other attribute or attributes are the best predictors of whether a particular mushroom is poisonous or edible?”

Your task is to study the dataset and the associated description of the data (i.e. “data dictionary”). You may need to look around a bit, but it’s there! You should take the data, and create a data frame with a subset of the columns in the dataset. You should include the column that indicates edible or poisonous and three or four other columns. You should also add meaningful column names and replace the abbreviations used in the data—for example, in the appropriate column, “e” might become “edible.” Your deliverable is the R code to perform these transformation tasks.

## Import Library

```{r library}
library(stringr)
```

## Read Mushrooms Dataset

As there is no header in the dataset and the default of header is TRUE, code "header=FALSE" is included.
"dim" can shows us how many rows and columns we have in the dataset.

```{r read}
mushroom <- read.csv("https://archive.ics.uci.edu/ml/machine-learning-databases/mushroom/agaricus-lepiota.data", header=FALSE)
mushroom = as.data.frame(mushroom)
dim(mushroom)
```

From the data dictionary it tells me that there are only 22 columns, therefore by checking the first column in the data with only "e" and "p", I can tell this 1st column is the class.

Checking:

```{r doublecheck}
unique(mushroom$V1)
```

## To check if there are any null values in the dataset

```{r null_check}
summary (data.frame (mushroom == "NULL"))
```

According to the result, there are no NULL values and we can move on.

## Create a data frame named "m_colortable" with a subset of a total of 5 columns in the dataset 

By choosing the Class and 6 other columns rated to colors, I created a data frame for them, named m_colortable.

```{r creatDF}
m_colortable <- mushroom[, c(1, 4, 10, 15, 16, 18, 21)]
```

## Apply meaningful column names

The 7 columns are Class, Cap_color, Gill_color, Stalk_color_above_ring, Stalk_color_below_ring, Veil_color, and SporePrint_color.

```{r colnames}
colnames(m_colortable) <- c("Class", "Cap_color", "Gill_color", "Stalk_color_above_ring", "Stalk_color_below_ring", "Veil_color", "SporePrint_color")
```

## Replace the abbreviations used in the data with meaningful words

Replace "e" as "edible", "p" as "poisonous" in column 1, and replace all the characters in the other 6 columns with their corresponding colors.

```{r Mushroom_ColorTable}
library(plyr)
m_colortable$Class <- revalue(m_colortable$Class, c("p" = "poisonous", "e" = "edible"))
m_colortable <- sapply(m_colortable, function(x) revalue(x,c("n"="brown", "b"="buff",                            "c"="cinnamon", "g"="gray", "r"="green", "p"="pink",
                       "u"="purple","e"="red","w"="white", "y"="yellow","k"="black",                             "h"="chocolate","o"="orange")))
m_colortable <- data.frame(m_colortable)
```

## To view the first 20 rows of the results as reference

```{r check}
head(m_colortable, 20)
```

## Let's see reshape the dataset and generate a table to see the result in a better way

```{r pivottable}
library(reshape2)
test <- melt(m_colortable, id.vars = c("Class"), variable.name = "Parts", value.names = "Color")
library(rpivotTable)
rpivotTable(test, rows = c("Parts","value"), cols = "Class", rendererName = "Table Barchart", width = "100%", height = "100%")

```

